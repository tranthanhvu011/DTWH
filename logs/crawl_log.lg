2024-10-30 21:02:01,071 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-30 21:02:01,071 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 21:02:01,072 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-30 21:02:01,072 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 21:02:01,072 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-30 21:02:01,072 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 21:02:01,073 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 21:02:01,073 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-30 21:02:01,073 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 21:02:01,078 INFO sqlalchemy.engine.Engine COMMIT
2024-10-30 21:02:01,078 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 21:02:01,079 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-30 21:02:01,079 INFO sqlalchemy.engine.Engine [generated in 0.00009s] {'timestamp': '2024-10-30 21:02:01', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-30 21:02:01', 'status': 'Success'}
2024-10-30 21:02:01,080 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-30 21:02:01 - Success
Sản phẩm 'Laptop gaming HP Victus 16 r0215TX 9Q9B8PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP Victus 16 s0142AX 9Q989PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP VICTUS 16-r0230TX 9Q981PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP VICTUS 16-r0226TX 9Q977PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP VICTUS 16-r0127TX 8C5N2PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP VICTUS 16-s0078AX 8C5N7PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP OMEN 16 wf0129TX 8W943PA' đã tồn tại. Bỏ qua.
2024-10-30 21:03:20,881 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 21:03:20,882 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-30 21:03:20,882 INFO sqlalchemy.engine.Engine [cached since 79.8s ago] {'timestamp': '2024-10-30 21:03:20', 'action': 'Add Products', 'details': 'Không có sản phẩm mới.', 'status': 'Info'}
2024-10-30 21:03:20,883 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Add Products - Không có sản phẩm mới. - Info
2024-10-30 21:03:20,884 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 21:03:20,884 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-30 21:03:20,884 INFO sqlalchemy.engine.Engine [cached since 79.8s ago] {'timestamp': '2024-10-30 21:03:20', 'action': 'End Crawl', 'details': 'Kết thúc crawl vào lúc 2024-10-30 21:03:20', 'status': 'Success'}
2024-10-30 21:03:20,885 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: End Crawl - Kết thúc crawl vào lúc 2024-10-30 21:03:20 - Success
2024-10-30 21:03:20,887 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 21:03:20,887 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-30 21:03:20,887 INFO sqlalchemy.engine.Engine [cached since 79.81s ago] {'timestamp': '2024-10-30 21:03:20', 'action': 'Summary', 'details': 'Tổng số sản phẩm crawl được: 7', 'status': 'Success'}
2024-10-30 21:03:20,887 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Summary - Tổng số sản phẩm crawl được: 7 - Success
2024-10-30 21:03:20,888 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 21:03:20,888 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-30 21:03:20,888 INFO sqlalchemy.engine.Engine [cached since 79.81s ago] {'timestamp': '2024-10-30 21:03:20', 'action': 'Summary', 'details': 'Tổng số sản phẩm mới thêm vào: 0', 'status': 'Success'}
2024-10-30 21:03:20,889 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Summary - Tổng số sản phẩm mới thêm vào: 0 - Success
Data saved to CSV files and log saved to MySQL successfully.
2024-10-30 22:02:01,131 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-30 22:02:01,132 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 22:02:01,135 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-30 22:02:01,135 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 22:02:01,135 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-30 22:02:01,135 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 22:02:01,136 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 22:02:01,136 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-30 22:02:01,136 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 22:02:01,148 INFO sqlalchemy.engine.Engine COMMIT
2024-10-30 22:02:01,149 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 22:02:01,150 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-30 22:02:01,150 INFO sqlalchemy.engine.Engine [generated in 0.00013s] {'timestamp': '2024-10-30 22:02:01', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-30 22:02:01', 'status': 'Success'}
2024-10-30 22:02:01,155 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-30 22:02:01 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 104, in <module>
    driver.get(product_link)
    ~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 389, in get
    self.execute(Command.GET, {"url": url})
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: disconnected: Unable to receive message from renderer
  (failed to check if window was closed: disconnected: not connected to DevTools)
  (Session info: chrome=130.0.6723.70)
Stacktrace:
0   chromedriver                        0x0000000104c37634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x0000000104c2fe94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x000000010469c104 cxxbridge1$string$len + 88416
3   chromedriver                        0x0000000104687704 cxxbridge1$string$len + 3936
4   chromedriver                        0x000000010468748c cxxbridge1$string$len + 3304
5   chromedriver                        0x0000000104686580 core::str::slice_error_fail::h1cab30ac4b13c655 + 63712
6   chromedriver                        0x00000001046a629c cxxbridge1$string$len + 129784
7   chromedriver                        0x0000000104717db0 cxxbridge1$string$len + 595468
8   chromedriver                        0x00000001046d2f54 cxxbridge1$string$len + 313264
9   chromedriver                        0x00000001046d3ba4 cxxbridge1$string$len + 316416
10  chromedriver                        0x0000000104c021d4 cxxbridge1$str$ptr + 3427196
11  chromedriver                        0x0000000104c05518 cxxbridge1$str$ptr + 3440320
12  chromedriver                        0x0000000104be95f8 cxxbridge1$str$ptr + 3325856
13  chromedriver                        0x0000000104c05ddc cxxbridge1$str$ptr + 3442564
14  chromedriver                        0x0000000104bda87c cxxbridge1$str$ptr + 3265060
15  chromedriver                        0x0000000104c20884 cxxbridge1$str$ptr + 3551788
16  chromedriver                        0x0000000104c20a00 cxxbridge1$str$ptr + 3552168
17  chromedriver                        0x0000000104c2fb2c cxxbridge1$str$ptr + 3613908
18  libsystem_pthread.dylib             0x00000001939cf2e4 _pthread_start + 136
19  libsystem_pthread.dylib             0x00000001939ca0fc thread_start + 8

2024-10-30 23:02:01,125 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-30 23:02:01,126 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 23:02:01,127 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-30 23:02:01,127 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 23:02:01,128 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-30 23:02:01,128 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 23:02:01,129 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 23:02:01,129 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-30 23:02:01,129 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-30 23:02:01,138 INFO sqlalchemy.engine.Engine COMMIT
2024-10-30 23:02:01,139 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-30 23:02:01,140 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-30 23:02:01,141 INFO sqlalchemy.engine.Engine [generated in 0.00018s] {'timestamp': '2024-10-30 23:02:01', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-30 23:02:01', 'status': 'Success'}
2024-10-30 23:02:01,144 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-30 23:02:01 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 108, in <module>
    product_name = driver.find_element(By.CSS_SELECTOR, '.product-name h1').text
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 766, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: disconnected: not connected to DevTools
  (failed to check if window was closed: disconnected: not connected to DevTools)
  (Session info: chrome=130.0.6723.70)
Stacktrace:
0   chromedriver                        0x000000010513f634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x0000000105137e94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x0000000104ba4104 cxxbridge1$string$len + 88416
3   chromedriver                        0x0000000104b8e3d0 core::str::slice_error_fail::h1cab30ac4b13c655 + 63280
4   chromedriver                        0x0000000104b8e310 core::str::slice_error_fail::h1cab30ac4b13c655 + 63088
5   chromedriver                        0x0000000104c1f654 cxxbridge1$string$len + 593584
6   chromedriver                        0x0000000104bdaf54 cxxbridge1$string$len + 313264
7   chromedriver                        0x0000000104bdbba4 cxxbridge1$string$len + 316416
8   chromedriver                        0x000000010510a1d4 cxxbridge1$str$ptr + 3427196
9   chromedriver                        0x000000010510d518 cxxbridge1$str$ptr + 3440320
10  chromedriver                        0x00000001050f15f8 cxxbridge1$str$ptr + 3325856
11  chromedriver                        0x000000010510dddc cxxbridge1$str$ptr + 3442564
12  chromedriver                        0x00000001050e287c cxxbridge1$str$ptr + 3265060
13  chromedriver                        0x0000000105128884 cxxbridge1$str$ptr + 3551788
14  chromedriver                        0x0000000105128a00 cxxbridge1$str$ptr + 3552168
15  chromedriver                        0x0000000105137b2c cxxbridge1$str$ptr + 3613908
16  libsystem_pthread.dylib             0x00000001939cf2e4 _pthread_start + 136
17  libsystem_pthread.dylib             0x00000001939ca0fc thread_start + 8

2024-10-31 00:02:01,324 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 00:02:01,325 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 00:02:01,326 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 00:02:01,326 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 00:02:01,326 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 00:02:01,326 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 00:02:01,327 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 00:02:01,327 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 00:02:01,327 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 00:02:01,333 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 00:02:01,335 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 00:02:01,337 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 00:02:01,337 INFO sqlalchemy.engine.Engine [generated in 0.00037s] {'timestamp': '2024-10-31 00:02:01', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 00:02:01', 'status': 'Success'}
2024-10-31 00:02:01,340 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 00:02:01 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Thin 15 B13UCX 2080VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop MSI Prestige 14 AI Studio C1VEG 056VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003PVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003NVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad X1 Carbon Gen 12 21KC009NVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad X13 Gen 5 21LU004TVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkBook 14 G7 IML 21MR006YVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkBook 14 G6 IRL 21KG00BQVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop ASUS Zenbook S 14 OLED UX5406SA PV140WS' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro 5 AN515 46 R6QR' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Predator Helios Neo 16 PHN16 72 78DQ' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV15 51 76B9' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV15 51 73UU' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Sword 16 HX B14VEKG 856VN' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 104, in <module>
    driver.get(product_link)
    ~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 389, in get
    self.execute(Command.GET, {"url": url})
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: disconnected: Unable to receive message from renderer
  (failed to check if window was closed: disconnected: not connected to DevTools)
  (Session info: chrome=130.0.6723.70)
Stacktrace:
0   chromedriver                        0x00000001049ef634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x00000001049e7e94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x0000000104454104 cxxbridge1$string$len + 88416
3   chromedriver                        0x000000010443f704 cxxbridge1$string$len + 3936
4   chromedriver                        0x000000010443f48c cxxbridge1$string$len + 3304
5   chromedriver                        0x000000010443e580 core::str::slice_error_fail::h1cab30ac4b13c655 + 63712
6   chromedriver                        0x000000010445e29c cxxbridge1$string$len + 129784
7   chromedriver                        0x00000001044cfdb0 cxxbridge1$string$len + 595468
8   chromedriver                        0x000000010448af54 cxxbridge1$string$len + 313264
9   chromedriver                        0x000000010448bba4 cxxbridge1$string$len + 316416
10  chromedriver                        0x00000001049ba1d4 cxxbridge1$str$ptr + 3427196
11  chromedriver                        0x00000001049bd518 cxxbridge1$str$ptr + 3440320
12  chromedriver                        0x00000001049a15f8 cxxbridge1$str$ptr + 3325856
13  chromedriver                        0x00000001049bdddc cxxbridge1$str$ptr + 3442564
14  chromedriver                        0x000000010499287c cxxbridge1$str$ptr + 3265060
15  chromedriver                        0x00000001049d8884 cxxbridge1$str$ptr + 3551788
16  chromedriver                        0x00000001049d8a00 cxxbridge1$str$ptr + 3552168
17  chromedriver                        0x00000001049e7b2c cxxbridge1$str$ptr + 3613908
18  libsystem_pthread.dylib             0x00000001939cf2e4 _pthread_start + 136
19  libsystem_pthread.dylib             0x00000001939ca0fc thread_start + 8

2024-10-31 11:02:18,746 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 11:02:18,748 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 11:02:18,751 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 11:02:18,751 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 11:02:18,751 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 11:02:18,751 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 11:02:18,752 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 11:02:18,753 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 11:02:18,753 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 11:02:18,769 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 11:02:18,770 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 11:02:18,771 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 11:02:18,771 INFO sqlalchemy.engine.Engine [generated in 0.00016s] {'timestamp': '2024-10-31 11:02:18', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 11:02:18', 'status': 'Success'}
2024-10-31 11:02:18,774 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 11:02:18 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Thin 15 B13UCX 2080VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop MSI Prestige 14 AI Studio C1VEG 056VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003PVA' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 108, in <module>
    product_name = driver.find_element(By.CSS_SELECTOR, '.product-name h1').text
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 766, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":".product-name h1"}
  (Session info: chrome=130.0.6723.70); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   chromedriver                        0x00000001006d3634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x00000001006cbe94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x0000000100138104 cxxbridge1$string$len + 88416
3   chromedriver                        0x000000010017a364 cxxbridge1$string$len + 359360
4   chromedriver                        0x00000001001b3bd0 cxxbridge1$string$len + 594988
5   chromedriver                        0x000000010016ef54 cxxbridge1$string$len + 313264
6   chromedriver                        0x000000010016fba4 cxxbridge1$string$len + 316416
7   chromedriver                        0x000000010069e1d4 cxxbridge1$str$ptr + 3427196
8   chromedriver                        0x00000001006a1518 cxxbridge1$str$ptr + 3440320
9   chromedriver                        0x00000001006855f8 cxxbridge1$str$ptr + 3325856
10  chromedriver                        0x00000001006a1ddc cxxbridge1$str$ptr + 3442564
11  chromedriver                        0x000000010067687c cxxbridge1$str$ptr + 3265060
12  chromedriver                        0x00000001006bc884 cxxbridge1$str$ptr + 3551788
13  chromedriver                        0x00000001006bca00 cxxbridge1$str$ptr + 3552168
14  chromedriver                        0x00000001006cbb2c cxxbridge1$str$ptr + 3613908
15  libsystem_pthread.dylib             0x0000000194d232e4 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000194d1e0fc thread_start + 8

2024-10-31 12:02:44,644 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 12:02:44,644 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 12:02:44,645 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 12:02:44,645 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 12:02:44,645 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 12:02:44,645 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 12:02:44,646 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 12:02:44,646 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 12:02:44,646 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 12:02:44,651 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 12:02:44,652 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 12:02:44,653 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 12:02:44,653 INFO sqlalchemy.engine.Engine [generated in 0.00017s] {'timestamp': '2024-10-31 12:02:44', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 12:02:44', 'status': 'Success'}
2024-10-31 12:02:44,654 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 12:02:44 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Thin 15 B13UCX 2080VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop MSI Prestige 14 AI Studio C1VEG 056VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003PVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003NVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad X1 Carbon Gen 12 21KC009NVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad X13 Gen 5 21LU004TVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkBook 14 G7 IML 21MR006YVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkBook 14 G6 IRL 21KG00BQVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop ASUS Zenbook S 14 OLED UX5406SA PV140WS' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro 5 AN515 46 R6QR' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Predator Helios Neo 16 PHN16 72 78DQ' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV15 51 76B9' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV15 51 73UU' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Sword 16 HX B14VEKG 856VN' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 108, in <module>
    product_name = driver.find_element(By.CSS_SELECTOR, '.product-name h1').text
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 766, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":".product-name h1"}
  (Session info: chrome=130.0.6723.70); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   chromedriver                        0x000000010545b634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x0000000105453e94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x0000000104ec0104 cxxbridge1$string$len + 88416
3   chromedriver                        0x0000000104f02364 cxxbridge1$string$len + 359360
4   chromedriver                        0x0000000104f3bbd0 cxxbridge1$string$len + 594988
5   chromedriver                        0x0000000104ef6f54 cxxbridge1$string$len + 313264
6   chromedriver                        0x0000000104ef7ba4 cxxbridge1$string$len + 316416
7   chromedriver                        0x00000001054261d4 cxxbridge1$str$ptr + 3427196
8   chromedriver                        0x0000000105429518 cxxbridge1$str$ptr + 3440320
9   chromedriver                        0x000000010540d5f8 cxxbridge1$str$ptr + 3325856
10  chromedriver                        0x0000000105429ddc cxxbridge1$str$ptr + 3442564
11  chromedriver                        0x00000001053fe87c cxxbridge1$str$ptr + 3265060
12  chromedriver                        0x0000000105444884 cxxbridge1$str$ptr + 3551788
13  chromedriver                        0x0000000105444a00 cxxbridge1$str$ptr + 3552168
14  chromedriver                        0x0000000105453b2c cxxbridge1$str$ptr + 3613908
15  libsystem_pthread.dylib             0x0000000194d232e4 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000194d1e0fc thread_start + 8

2024-10-31 14:02:25,355 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 14:02:25,356 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 14:02:25,357 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 14:02:25,357 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 14:02:25,357 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 14:02:25,357 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 14:02:25,358 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 14:02:25,358 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 14:02:25,358 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 14:02:25,365 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 14:02:25,366 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 14:02:25,368 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 14:02:25,368 INFO sqlalchemy.engine.Engine [generated in 0.00017s] {'timestamp': '2024-10-31 14:02:25', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 14:02:25', 'status': 'Success'}
2024-10-31 14:02:25,369 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 14:02:25 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Thin 15 B13UCX 2080VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop MSI Prestige 14 AI Studio C1VEG 056VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003PVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003NVA' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 108, in <module>
    product_name = driver.find_element(By.CSS_SELECTOR, '.product-name h1').text
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 766, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":".product-name h1"}
  (Session info: chrome=130.0.6723.70); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   chromedriver                        0x000000010265f634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x0000000102657e94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x00000001020c4104 cxxbridge1$string$len + 88416
3   chromedriver                        0x0000000102106364 cxxbridge1$string$len + 359360
4   chromedriver                        0x000000010213fbd0 cxxbridge1$string$len + 594988
5   chromedriver                        0x00000001020faf54 cxxbridge1$string$len + 313264
6   chromedriver                        0x00000001020fbba4 cxxbridge1$string$len + 316416
7   chromedriver                        0x000000010262a1d4 cxxbridge1$str$ptr + 3427196
8   chromedriver                        0x000000010262d518 cxxbridge1$str$ptr + 3440320
9   chromedriver                        0x00000001026115f8 cxxbridge1$str$ptr + 3325856
10  chromedriver                        0x000000010262dddc cxxbridge1$str$ptr + 3442564
11  chromedriver                        0x000000010260287c cxxbridge1$str$ptr + 3265060
12  chromedriver                        0x0000000102648884 cxxbridge1$str$ptr + 3551788
13  chromedriver                        0x0000000102648a00 cxxbridge1$str$ptr + 3552168
14  chromedriver                        0x0000000102657b2c cxxbridge1$str$ptr + 3613908
15  libsystem_pthread.dylib             0x0000000194d232e4 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000194d1e0fc thread_start + 8

2024-10-31 16:02:25,218 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 16:02:25,218 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 16:02:25,219 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 16:02:25,219 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 16:02:25,219 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 16:02:25,219 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 16:02:25,219 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 16:02:25,219 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 16:02:25,219 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 16:02:25,225 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 16:02:25,226 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 16:02:25,227 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 16:02:25,227 INFO sqlalchemy.engine.Engine [generated in 0.00007s] {'timestamp': '2024-10-31 16:02:25', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 16:02:25', 'status': 'Success'}
2024-10-31 16:02:25,228 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 16:02:25 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Thin 15 B13UCX 2080VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop MSI Prestige 14 AI Studio C1VEG 056VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003PVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003NVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad X1 Carbon Gen 12 21KC009NVN' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 108, in <module>
    product_name = driver.find_element(By.CSS_SELECTOR, '.product-name h1').text
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 766, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":".product-name h1"}
  (Session info: chrome=130.0.6723.70); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   chromedriver                        0x0000000100713634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x000000010070be94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x0000000100178104 cxxbridge1$string$len + 88416
3   chromedriver                        0x00000001001ba364 cxxbridge1$string$len + 359360
4   chromedriver                        0x00000001001f3bd0 cxxbridge1$string$len + 594988
5   chromedriver                        0x00000001001aef54 cxxbridge1$string$len + 313264
6   chromedriver                        0x00000001001afba4 cxxbridge1$string$len + 316416
7   chromedriver                        0x00000001006de1d4 cxxbridge1$str$ptr + 3427196
8   chromedriver                        0x00000001006e1518 cxxbridge1$str$ptr + 3440320
9   chromedriver                        0x00000001006c55f8 cxxbridge1$str$ptr + 3325856
10  chromedriver                        0x00000001006e1ddc cxxbridge1$str$ptr + 3442564
11  chromedriver                        0x00000001006b687c cxxbridge1$str$ptr + 3265060
12  chromedriver                        0x00000001006fc884 cxxbridge1$str$ptr + 3551788
13  chromedriver                        0x00000001006fca00 cxxbridge1$str$ptr + 3552168
14  chromedriver                        0x000000010070bb2c cxxbridge1$str$ptr + 3613908
15  libsystem_pthread.dylib             0x0000000194d232e4 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000194d1e0fc thread_start + 8

2024-10-31 17:06:06,152 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 17:06:06,152 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 17:06:06,153 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 17:06:06,153 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 17:06:06,154 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 17:06:06,154 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 17:06:06,155 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 17:06:06,155 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 17:06:06,155 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 17:06:06,162 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 17:06:06,163 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 17:06:06,165 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 17:06:06,165 INFO sqlalchemy.engine.Engine [generated in 0.00017s] {'timestamp': '2024-10-31 17:06:06', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 17:06:06', 'status': 'Success'}
2024-10-31 17:06:06,166 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 17:06:06 - Success
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 108, in <module>
    product_name = driver.find_element(By.CSS_SELECTOR, '.product-name h1').text
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 766, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":".product-name h1"}
  (Session info: chrome=130.0.6723.70); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   chromedriver                        0x00000001050a3634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x000000010509be94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x0000000104b08104 cxxbridge1$string$len + 88416
3   chromedriver                        0x0000000104b4a364 cxxbridge1$string$len + 359360
4   chromedriver                        0x0000000104b83bd0 cxxbridge1$string$len + 594988
5   chromedriver                        0x0000000104b3ef54 cxxbridge1$string$len + 313264
6   chromedriver                        0x0000000104b3fba4 cxxbridge1$string$len + 316416
7   chromedriver                        0x000000010506e1d4 cxxbridge1$str$ptr + 3427196
8   chromedriver                        0x0000000105071518 cxxbridge1$str$ptr + 3440320
9   chromedriver                        0x00000001050555f8 cxxbridge1$str$ptr + 3325856
10  chromedriver                        0x0000000105071ddc cxxbridge1$str$ptr + 3442564
11  chromedriver                        0x000000010504687c cxxbridge1$str$ptr + 3265060
12  chromedriver                        0x000000010508c884 cxxbridge1$str$ptr + 3551788
13  chromedriver                        0x000000010508ca00 cxxbridge1$str$ptr + 3552168
14  chromedriver                        0x000000010509bb2c cxxbridge1$str$ptr + 3613908
15  libsystem_pthread.dylib             0x0000000194d232e4 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000194d1e0fc thread_start + 8

2024-10-31 18:02:19,561 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 18:02:19,561 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 18:02:19,562 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 18:02:19,563 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 18:02:19,563 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 18:02:19,563 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 18:02:19,564 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 18:02:19,564 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 18:02:19,564 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 18:02:19,571 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 18:02:19,572 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 18:02:19,574 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 18:02:19,574 INFO sqlalchemy.engine.Engine [generated in 0.00018s] {'timestamp': '2024-10-31 18:02:19', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 18:02:19', 'status': 'Success'}
2024-10-31 18:02:19,575 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 18:02:19 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Thin 15 B13UCX 2080VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop MSI Prestige 14 AI Studio C1VEG 056VN' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 108, in <module>
    product_name = driver.find_element(By.CSS_SELECTOR, '.product-name h1').text
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 766, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":".product-name h1"}
  (Session info: chrome=130.0.6723.70); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   chromedriver                        0x00000001014af634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x00000001014a7e94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x0000000100f14104 cxxbridge1$string$len + 88416
3   chromedriver                        0x0000000100f56364 cxxbridge1$string$len + 359360
4   chromedriver                        0x0000000100f8fbd0 cxxbridge1$string$len + 594988
5   chromedriver                        0x0000000100f4af54 cxxbridge1$string$len + 313264
6   chromedriver                        0x0000000100f4bba4 cxxbridge1$string$len + 316416
7   chromedriver                        0x000000010147a1d4 cxxbridge1$str$ptr + 3427196
8   chromedriver                        0x000000010147d518 cxxbridge1$str$ptr + 3440320
9   chromedriver                        0x00000001014615f8 cxxbridge1$str$ptr + 3325856
10  chromedriver                        0x000000010147dddc cxxbridge1$str$ptr + 3442564
11  chromedriver                        0x000000010145287c cxxbridge1$str$ptr + 3265060
12  chromedriver                        0x0000000101498884 cxxbridge1$str$ptr + 3551788
13  chromedriver                        0x0000000101498a00 cxxbridge1$str$ptr + 3552168
14  chromedriver                        0x00000001014a7b2c cxxbridge1$str$ptr + 3613908
15  libsystem_pthread.dylib             0x0000000194d232e4 _pthread_start + 136
16  libsystem_pthread.dylib             0x0000000194d1e0fc thread_start + 8

2024-10-31 19:02:24,431 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 19:02:24,431 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 19:02:24,432 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 19:02:24,432 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 19:02:24,432 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 19:02:24,432 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 19:02:24,432 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 19:02:24,432 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 19:02:24,432 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 19:02:24,438 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 19:02:24,438 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 19:02:24,439 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 19:02:24,439 INFO sqlalchemy.engine.Engine [generated in 0.00006s] {'timestamp': '2024-10-31 19:02:24', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 19:02:24', 'status': 'Success'}
2024-10-31 19:02:24,440 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 19:02:24 - Success
2024-10-31 19:02:39,835 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 19:02:39,836 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 19:02:39,836 INFO sqlalchemy.engine.Engine [cached since 9.302s ago] {'timestamp': '2024-10-31 19:02:39', 'action': 'Add Products', 'details': 'Không có sản phẩm mới.', 'status': 'Info'}
2024-10-31 19:02:39,837 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Add Products - Không có sản phẩm mới. - Info
2024-10-31 19:02:39,838 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 19:02:39,838 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 19:02:39,838 INFO sqlalchemy.engine.Engine [cached since 9.304s ago] {'timestamp': '2024-10-31 19:02:39', 'action': 'End Crawl', 'details': 'Kết thúc crawl vào lúc 2024-10-31 19:02:39', 'status': 'Success'}
2024-10-31 19:02:39,838 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: End Crawl - Kết thúc crawl vào lúc 2024-10-31 19:02:39 - Success
2024-10-31 19:02:39,839 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 19:02:39,839 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 19:02:39,839 INFO sqlalchemy.engine.Engine [cached since 9.305s ago] {'timestamp': '2024-10-31 19:02:39', 'action': 'Summary', 'details': 'Tổng số sản phẩm crawl được: 0', 'status': 'Success'}
2024-10-31 19:02:39,839 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Summary - Tổng số sản phẩm crawl được: 0 - Success
2024-10-31 19:02:39,840 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 19:02:39,840 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 19:02:39,840 INFO sqlalchemy.engine.Engine [cached since 9.306s ago] {'timestamp': '2024-10-31 19:02:39', 'action': 'Summary', 'details': 'Tổng số sản phẩm mới thêm vào: 0', 'status': 'Success'}
2024-10-31 19:02:39,840 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Summary - Tổng số sản phẩm mới thêm vào: 0 - Success
Data saved to CSV files and log saved to MySQL successfully.
2024-10-31 20:02:01,453 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-10-31 20:02:01,453 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 20:02:01,454 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-10-31 20:02:01,454 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 20:02:01,455 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-10-31 20:02:01,455 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 20:02:01,456 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 20:02:01,456 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-10-31 20:02:01,456 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-10-31 20:02:01,463 INFO sqlalchemy.engine.Engine COMMIT
2024-10-31 20:02:01,464 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-10-31 20:02:01,465 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-10-31 20:02:01,465 INFO sqlalchemy.engine.Engine [generated in 0.00019s] {'timestamp': '2024-10-31 20:02:01', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-10-31 20:02:01', 'status': 'Success'}
2024-10-31 20:02:01,467 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-10-31 20:02:01 - Success
Sản phẩm 'Laptop MSI Modern 15 F13MG 082VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Thin 15 B13UCX 2080VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop MSI Prestige 14 AI Studio C1VEG 056VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003PVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad P14s Gen 5 21G2003NVA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad X1 Carbon Gen 12 21KC009NVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad X13 Gen 5 21LU004TVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkBook 14 G7 IML 21MR006YVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkBook 14 G6 IRL 21KG00BQVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop ASUS Zenbook S 14 OLED UX5406SA PV140WS' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro 5 AN515 46 R6QR' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Predator Helios Neo 16 PHN16 72 78DQ' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV15 51 76B9' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV15 51 73UU' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Sword 16 HX B14VEKG 856VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP Victus 16 r0215TX 9Q9B8PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP Victus 16 s0142AX 9Q989PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Predator Triton Neo 16 PTN16 51 78JQ' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Acer Swift X14 SFX14 72G 79UW' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Acer Swift X14 SFX14 72G 708X' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Acer Swift X14 SFX14 72G 77F9' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo ThinkPad E16 Gen 1 21JN00GJVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming ASUS ROG Strix SCAR 16 G634JYR RA132W' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop ASUS Vivobook S 14 OLED M5406WA PP071WS' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop ASUS Vivobook S 14 OLED S5406MA PP046WS' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Acer Swift Go 14 SFG14 73 75YM' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV15 51 57B2' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Acer Swift Go 14 SFG14 73 57FZ' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming ASUS ROG Zephyrus G16 GA605WI QR090WS' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP VICTUS 16-r0230TX 9Q981PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP VICTUS 16-r0226TX 9Q977PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming HP VICTUS 16-r0127TX 8C5N2PA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Lenovo LOQ 15ARP9 83JC003YVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Lenovo Legion 5 15IRX9 83JJ000FVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Lenovo Yoga Pro 7 14IMH9 83E2006MVN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming ASUS TUF Gaming A15 FA507NV LP061W' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop Gaming MSI Stealth 18 AI Studio A1VHG 025VN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Predator Helios Neo 14 PHN14 51 96HG' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Predator Helios Neo 14 PHN14 51 99Y8' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming ASUS Vivobook 16X K3605ZC RP564W' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming ASUS Vivobook 16X K3605ZU RP296W' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV16 41 R36Y' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Predator Helios Neo 16 PHN16 72 950P' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV16 41 R6NA' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV16 41 R7EN' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming Acer Nitro V ANV16 41 R6ZY' đã tồn tại. Bỏ qua.
Sản phẩm 'Laptop gaming MSI Stealth 18 Mercedes AMG A1VHG 080VN' đã tồn tại. Bỏ qua.
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 104, in <module>
    driver.get(product_link)
    ~~~~~~~~~~^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 389, in get
    self.execute(Command.GET, {"url": url})
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: disconnected: Unable to receive message from renderer
  (failed to check if window was closed: disconnected: not connected to DevTools)
  (Session info: chrome=130.0.6723.70)
Stacktrace:
0   chromedriver                        0x00000001007e7634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x00000001007dfe94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x000000010024c104 cxxbridge1$string$len + 88416
3   chromedriver                        0x0000000100237704 cxxbridge1$string$len + 3936
4   chromedriver                        0x000000010023748c cxxbridge1$string$len + 3304
5   chromedriver                        0x0000000100236580 core::str::slice_error_fail::h1cab30ac4b13c655 + 63712
6   chromedriver                        0x000000010025629c cxxbridge1$string$len + 129784
7   chromedriver                        0x00000001002c7db0 cxxbridge1$string$len + 595468
8   chromedriver                        0x0000000100282f54 cxxbridge1$string$len + 313264
9   chromedriver                        0x0000000100283ba4 cxxbridge1$string$len + 316416
10  chromedriver                        0x00000001007b21d4 cxxbridge1$str$ptr + 3427196
11  chromedriver                        0x00000001007b5518 cxxbridge1$str$ptr + 3440320
12  chromedriver                        0x00000001007995f8 cxxbridge1$str$ptr + 3325856
13  chromedriver                        0x00000001007b5ddc cxxbridge1$str$ptr + 3442564
14  chromedriver                        0x000000010078a87c cxxbridge1$str$ptr + 3265060
15  chromedriver                        0x00000001007d0884 cxxbridge1$str$ptr + 3551788
16  chromedriver                        0x00000001007d0a00 cxxbridge1$str$ptr + 3552168
17  chromedriver                        0x00000001007dfb2c cxxbridge1$str$ptr + 3613908
18  libsystem_pthread.dylib             0x0000000194d232e4 _pthread_start + 136
19  libsystem_pthread.dylib             0x0000000194d1e0fc thread_start + 8

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 649, in connect
    sock = socket.create_connection(
        (self.host, self.port), self.connect_timeout, **kwargs
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 864, in create_connection
    raise exceptions[0]
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 849, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 23, in <module>
    metadata.create_all(engine)  # Tạo bảng nếu chưa có
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/sql/schema.py", line 5868, in create_all
    bind._run_ddl_visitor(
    ~~~~~~~~~~~~~~~~~~~~~^
        ddl.SchemaGenerator, self, checkfirst=checkfirst, tables=tables
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3252, in _run_ddl_visitor
    with self.begin() as conn:
         ~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 141, in __enter__
    return next(self.gen)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3242, in begin
    with self.connect() as conn:
         ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3278, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2442, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3302, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 712, in checkout
    rec = pool._do_get()
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 674, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 900, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 643, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 621, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 361, in __init__
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/pymysql/connections.py", line 716, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-11-06 11:02:02,575 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-11-06 11:02:02,576 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 11:02:02,577 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-11-06 11:02:02,577 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 11:02:02,577 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-11-06 11:02:02,577 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 11:02:02,578 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-11-06 11:02:02,578 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-11-06 11:02:02,578 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 11:02:02,587 INFO sqlalchemy.engine.Engine COMMIT
2024-11-06 11:02:02,588 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-11-06 11:02:02,590 INFO sqlalchemy.engine.Engine INSERT INTO logs (timestamp, action, details, status) VALUES (%(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-11-06 11:02:02,590 INFO sqlalchemy.engine.Engine [generated in 0.00018s] {'timestamp': '2024-11-06 11:02:02', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-11-06 11:02:02', 'status': 'Success'}
2024-11-06 11:02:02,592 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-11-06 11:02:02 - Success
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 91, in <module>
    product_elements = driver.find_elements(By.CSS_SELECTOR, '.proloop .proloop-name a')
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 788, in find_elements
    return self.execute(Command.FIND_ELEMENTS, {"using": by, "value": value})["value"] or []
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 380, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/thanhvu/myprojectenv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 229, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchWindowException: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=130.0.6723.116)
Stacktrace:
0   chromedriver                        0x000000010293f634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x0000000102937e94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x00000001023a4104 cxxbridge1$string$len + 88416
3   chromedriver                        0x000000010237fb70 core::str::slice_error_fail::h1cab30ac4b13c655 + 3792
4   chromedriver                        0x000000010240c66c cxxbridge1$string$len + 515784
5   chromedriver                        0x000000010241f638 cxxbridge1$string$len + 593556
6   chromedriver                        0x00000001023daf54 cxxbridge1$string$len + 313264
7   chromedriver                        0x00000001023dbba4 cxxbridge1$string$len + 316416
8   chromedriver                        0x000000010290a1d4 cxxbridge1$str$ptr + 3427196
9   chromedriver                        0x000000010290d518 cxxbridge1$str$ptr + 3440320
10  chromedriver                        0x00000001028f15f8 cxxbridge1$str$ptr + 3325856
11  chromedriver                        0x000000010290dddc cxxbridge1$str$ptr + 3442564
12  chromedriver                        0x00000001028e287c cxxbridge1$str$ptr + 3265060
13  chromedriver                        0x0000000102928884 cxxbridge1$str$ptr + 3551788
14  chromedriver                        0x0000000102928a00 cxxbridge1$str$ptr + 3552168
15  chromedriver                        0x0000000102937b2c cxxbridge1$str$ptr + 3613908
16  libsystem_pthread.dylib             0x000000018ce5f2e4 _pthread_start + 136
17  libsystem_pthread.dylib             0x000000018ce5a0fc thread_start + 8

2024-11-06 12:02:01,020 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-11-06 12:02:01,020 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 12:02:01,021 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-11-06 12:02:01,021 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 12:02:01,021 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-11-06 12:02:01,021 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 12:02:01,022 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-11-06 12:02:01,022 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`config`
2024-11-06 12:02:01,022 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 12:02:01,027 INFO sqlalchemy.engine.Engine DESCRIBE `dtwh`.`logs`
2024-11-06 12:02:01,027 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 12:02:01,031 INFO sqlalchemy.engine.Engine COMMIT
2024-11-06 12:02:01,032 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-11-06 12:02:01,033 INFO sqlalchemy.engine.Engine SELECT config.id, config.data 
FROM config
2024-11-06 12:02:01,033 INFO sqlalchemy.engine.Engine [generated in 0.00014s] {}
2024-11-06 12:02:01,033 INFO sqlalchemy.engine.Engine ROLLBACK
2024-11-06 12:02:02,198 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-11-06 12:02:02,199 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 12:02:02,200 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-11-06 12:02:02,203 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 12:02:02,203 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-11-06 12:02:02,203 INFO sqlalchemy.engine.Engine [raw sql] {}
2024-11-06 12:02:02,204 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-11-06 12:02:02,206 INFO sqlalchemy.engine.Engine INSERT INTO logs (config_id, timestamp, action, details, status) VALUES (%(config_id)s, %(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-11-06 12:02:02,208 INFO sqlalchemy.engine.Engine [generated in 0.00228s] {'config_id': 1, 'timestamp': '2024-11-06 12:02:02', 'action': 'Start Crawl', 'details': 'Bắt đầu crawl vào lúc 2024-11-06 12:02:02', 'status': 'Success'}
2024-11-06 12:02:02,209 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: Start Crawl - Bắt đầu crawl vào lúc 2024-11-06 12:02:02 - Success
Lỗi trong quá trình crawl: Message: no such window: target window already closed
from unknown error: web view not found
  (Session info: chrome=130.0.6723.116)
Stacktrace:
0   chromedriver                        0x000000010147b634 cxxbridge1$str$ptr + 3645404
1   chromedriver                        0x0000000101473e94 cxxbridge1$str$ptr + 3614780
2   chromedriver                        0x0000000100ee0104 cxxbridge1$string$len + 88416
3   chromedriver                        0x0000000100ebbb70 core::str::slice_error_fail::h1cab30ac4b13c655 + 3792
4   chromedriver                        0x0000000100f4866c cxxbridge1$string$len + 515784
5   chromedriver                        0x0000000100f5b638 cxxbridge1$string$len + 593556
6   chromedriver                        0x0000000100f16f54 cxxbridge1$string$len + 313264
7   chromedriver                        0x0000000100f17ba4 cxxbridge1$string$len + 316416
8   chromedriver                        0x00000001014461d4 cxxbridge1$str$ptr + 3427196
9   chromedriver                        0x0000000101449518 cxxbridge1$str$ptr + 3440320
10  chromedriver                        0x000000010142d5f8 cxxbridge1$str$ptr + 3325856
11  chromedriver                        0x0000000101449ddc cxxbridge1$str$ptr + 3442564
12  chromedriver                        0x000000010141e87c cxxbridge1$str$ptr + 3265060
13  chromedriver                        0x0000000101464884 cxxbridge1$str$ptr + 3551788
14  chromedriver                        0x0000000101464a00 cxxbridge1$str$ptr + 3552168
15  chromedriver                        0x0000000101473b2c cxxbridge1$str$ptr + 3613908
16  libsystem_pthread.dylib             0x000000018ce5f2e4 _pthread_start + 136
17  libsystem_pthread.dylib             0x000000018ce5a0fc thread_start + 8

2024-11-06 12:02:11,088 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-11-06 12:02:11,089 INFO sqlalchemy.engine.Engine INSERT INTO logs (config_id, timestamp, action, details, status) VALUES (%(config_id)s, %(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-11-06 12:02:11,089 INFO sqlalchemy.engine.Engine [cached since 8.884s ago] {'config_id': 1, 'timestamp': '2024-11-06 12:02:11', 'action': 'Crawl Failed', 'details': 'Lỗi trong quá trình crawl: Message: no such window: target window already closed\nfrom unknown error: web view not found\n  (Session info: chrome=130 ... (1494 characters truncated) ... stem_pthread.dylib             0x000000018ce5f2e4 _pthread_start + 136\n17  libsystem_pthread.dylib             0x000000018ce5a0fc thread_start + 8\n', 'status': 'Failed'}
2024-11-06 12:02:11,093 INFO sqlalchemy.engine.Engine ROLLBACK
Lỗi khi ghi log vào MySQL: (pymysql.err.DataError) (1406, "Data too long for column 'details' at row 1")
[SQL: INSERT INTO logs (config_id, timestamp, action, details, status) VALUES (%(config_id)s, %(timestamp)s, %(action)s, %(details)s, %(status)s)]
[parameters: {'config_id': 1, 'timestamp': '2024-11-06 12:02:11', 'action': 'Crawl Failed', 'details': 'Lỗi trong quá trình crawl: Message: no such window: target window already closed\nfrom unknown error: web view not found\n  (Session info: chrome=130 ... (1494 characters truncated) ... stem_pthread.dylib             0x000000018ce5f2e4 _pthread_start + 136\n17  libsystem_pthread.dylib             0x000000018ce5a0fc thread_start + 8\n', 'status': 'Failed'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2024-11-06 12:02:11,094 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-11-06 12:02:11,094 INFO sqlalchemy.engine.Engine INSERT INTO logs (config_id, timestamp, action, details, status) VALUES (%(config_id)s, %(timestamp)s, %(action)s, %(details)s, %(status)s)
2024-11-06 12:02:11,094 INFO sqlalchemy.engine.Engine [cached since 8.888s ago] {'config_id': 1, 'timestamp': '2024-11-06 12:02:11', 'action': 'End Crawl', 'details': 'Kết thúc crawl vào lúc 2024-11-06 12:02:11', 'status': 'Success'}
2024-11-06 12:02:11,097 INFO sqlalchemy.engine.Engine COMMIT
Log entry added: End Crawl - Kết thúc crawl vào lúc 2024-11-06 12:02:11 - Success
Traceback (most recent call last):
  File "/Users/thanhvu/Documents/python/pythonProject/Crawdata.py", line 210, in <module>
    if products_list:
       ^^^^^^^^^^^^^
NameError: name 'products_list' is not defined. Did you mean: 'products_csv'?
